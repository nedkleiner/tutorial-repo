timeconstant=38;
num=ncread('~/placeholder.nc','A');
zonal_i=zeros(144,96,26,2);
merid_i=zeros(144,96,26,2);
upward_i=zeros(144,96,26,2);
humid_i=zeros(144,96,26,2);
temp_i=zeros(144,96,26,2);
surf_i=zeros(144,96,2);
zonal_f=zeros(144,96,26,2);
merid_f=zeros(144,96,26,2);
upward_f=zeros(144,96,26,2);
humid_f=zeros(144,96,26,2);
temp_f=zeros(144,96,26,2);
surf_f=zeros(144,96,2);
for i=1:timeconstant
format_i='/n/regal/kuang_lab/nedkleiner/cesm_output/1rest%02d/atm/hist/1rest%02d.cam.h1.0001-01-15-00000.nc';
%    format_i='/n/regal/kuang_lab/nedkleiner/cesm_output/2astep%02d/atm/hist/2astep%02d.cam.h1.0001-01-16-01800.nc';
    format_f='/n/regal/kuang_lab/nedkleiner/cesm_output/%datry%02d/atm/hist/%datry%02d.cam.h1.0001-01-16-%05d.nc';
%    format_f2='/n/regal/kuang_lab/nedkleiner/cesm_output/3restart%02d/atm/hist/3restart%02d.cam.h1.0001-01-17-00000.nc';
    string_i=sprintf(format_i,i,i);
    string_f=sprintf(format_f,num,i,num,i,num*3600-1800);
%    string_f2=sprintf(format_f2,i,i);
    zonal_i=zonal_i+ncread(string_i,'U');
    zonal_f=zonal_f+ncread(string_f,'U');%+ncread(string_f2,'U');
    merid_i=merid_i+ncread(string_i,'V');
    merid_f=merid_f+ncread(string_f,'V');%+ncread(string_f2,'V');
    upward_i=upward_i+ncread(string_i,'OMEGA');
    upward_f=upward_f+ncread(string_f,'OMEGA');%+ncread(string_f2,'OMEGA');
    humid_i=humid_i+ncread(string_i,'Q');
    humid_f=humid_f+ncread(string_f,'Q');%+ncread(string_f2,'Q');
    temp_i=temp_i+ncread(string_i,'T');
    temp_f=temp_f+ncread(string_f,'T');%+ncread(string_f2,'T');
	surf_i=surf_i+ncread(string_i,'PS');
	surf_f=surf_f+ncread(string_f,'PS');
end
%umean=string(int32(squeeze(zonal_i(:,:,:,4))*10000000/timeconstant));
%tmean=string(int32(squeeze(temp_(:,:,:,4))*100000/timeconstant));
%wmean=string(int32(squeeze(upward_i(:,:,:,4))*10000000/timeconstant));
%qmean=string(int32(squeeze(humid_i(:,:,:,4))*10000000/timeconstant));
%vmean=string(int32(squeeze(merid_i(:,:,:,4))*10000000/timeconstant));
%UU=fopen('~/forcing_txt/UU.txt','wt');
%VV=fopen('~/forcing_txt/VV.txt','wt');
%WW=fopen('~/forcing_txt/WW.txt','wt');
%TT=fopen('~/forcing_txt/TT.txt','wt');
%QQ=fopen('~/forcing_txt/QQ.txt','wt');
%fprintf(UU,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',umean);
%fprintf(VV,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',vmean);
%fprintf(WW,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',wmean);
%fprintf(TT,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',tmean);
%fprintf(QQ,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',qmean);
udrift=string(int32((squeeze(zonal_f(:,:,:,2))-squeeze(zonal_i(:,:,:,2)))*10000000/timeconstant));
tdrift=string(int32((squeeze(temp_f(:,:,:,2))-squeeze(temp_i(:,:,:,2)))*10000000/timeconstant));
wdrift=string(int32((squeeze(upward_f(:,:,:,2))-squeeze(upward_i(:,:,:,2)))*10000000/timeconstant));
qdrift=string(int32((squeeze(humid_f(:,:,:,2))-squeeze(humid_i(:,:,:,2)))*10000000/timeconstant));
vdrift=string(int32((squeeze(merid_f(:,:,:,2))-squeeze(merid_i(:,:,:,2)))*10000000/timeconstant));
pdrift=string(int32((squeeze(surf_f(:,:,2))-squeeze(surf_i(:,:,2)))*100000/timeconstant));
U_drft=fopen('~/forcing_txt/wide/U_drft.txt','wt');
V_drft=fopen('~/forcing_txt/wide/V_drft.txt','wt');
W_drft=fopen('~/forcing_txt/wide/W_drft.txt','wt');
T_drft=fopen('~/forcing_txt/wide/T_drft.txt','wt');
Q_drft=fopen('~/forcing_txt/wide/Q_drft.txt','wt');
P_drft=fopen('~/forcing_txt/wide/P_drft.txt','wt');
fprintf(U_drft,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',udrift);
fprintf(V_drft,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',vdrift);
fprintf(W_drft,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',wdrift);
fprintf(T_drft,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',tdrift);
fprintf(P_drft,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',pdrift);
fprintf(Q_drft,'%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s%11s\n',qdrift);
ncwrite('~/placeholder.nc','A',num+1)
exit
